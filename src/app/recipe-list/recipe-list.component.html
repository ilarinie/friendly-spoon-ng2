<div class="container-fluid recipe-list">
  <h1>Friendly Spoon</h1>
  <h3>is here for you!</h3>
  <div class="row main-row">
    <div class="col-xs-13 col-sm-13 col-md-13 col-lg-13">
      <md-input class="recipe-search" type="text" id="searchText" #listFilter [(ngModel)]="listfilter" (keyup)="0" placeholder="Filter recipes"></md-input>
      <span class="clearbutton glyphicon glyphicon-remove" (click)="clearSearch()"></span>
    </div>
  </div>
  <div class="row main-row">
    <div class="col-xs-13 col-sm-13 col-md-13 col-lg-13">
      <label>Filter by tags</label>
      <select class="form-control" #searchTagger (change)="tagChange($event.target.value)">
        <option></option>
        <option *ngFor="let tag of tags" value="{{tag.title}}">{{tag.title}}</option>
      </select>
    </div>
  </div>
  <div class="row main-row">
    <div class="col-xs-13 col-sm-13 col-md-13 col-lg-13 buttons-row">
        <button md-raised-button (click)="sortByName()">ABC <span class="glyphicon glyphicon-sort"></span></button>
        <button md-raised-button (click)="sortByRating()">Rating <span class="glyphicon glyphicon-sort"></span></button>
        <button md-raised-button (click)="sortByTime()">Time <span class="glyphicon glyphicon-sort"></span></button>
        <button md-raised-button (click)="random()" data-toggle="modal" data-target="#myModal">Random recipe!</button>
        <button md-raised-button (click)="refreshRecipes()"><span class="glyphicon glyphicon-refresh refresh"></span></button>
    </div>
  </div>
  <div class="row main-row">
    <div class="col-xs-13 col-sm-13 col-md-13 col-lg-13">
      <div *ngIf="!loading">

        <div class="col-xs-13 col-sm-13 col-md-6 col-lg-6" *ngFor="let recipe of shownRecipes | filter:listFilter.value | orderBy: order">
          <md-card>
            <md-card-title-group>
              <div *ngIf="!recipe.coverpicture"><img md-card-sm-img src="assets/baking.png" alt="nice pic yo"></div>
              <div *ngIf="recipe.coverpicture"><img md-card-sm-img class="img-responsive" src="{{baseUrl}}{{recipe.coverpicture.picture.thumb.url}}"></div>

              <md-card-title><a routerLink="/recipes/{{recipe.id}}">{{recipe.name}}</a></md-card-title>
              <md-card-subtitle>
                <span *ngIf="recipe.ratingaverage"><rating [(ngModel)]="recipe.ratingaverage" [readonly]="true"></rating></span>
                <span *ngIf="!recipe.ratingaverage"><rating [(ngModel)]="zeroRating" [readonly]="true"></rating></span>
              </md-card-subtitle>
              <md-card-subtitle>
                <span *ngIf="recipe.duration.range">{{recipe.duration.range}}</span>
                <span *ngIf="!recipe.duration.range">No duration set</span>
              </md-card-subtitle>
              <md-card-subtitle>
                <span *ngIf="recipe.introduction">{{recipe.introduction}}</span>
                <span *ngIf="!recipe.introduction">No introduction set</span>
              </md-card-subtitle>
            </md-card-title-group>
          </md-card>
        </div>
        <!--
                    <table class="table">
                        <thead>
                            <tr class="recipe-list-headers">
                            <th class="col-md-4"> <a (click)="sortByName()">Recipe <span class="glyphicon glyphicon-sort"></span></a> </th>
                            <th class="col-md-3"> <a (click)="sortByRating()">Rating <span class="glyphicon glyphicon-sort"></span></a> </th>
                            <th class="col-md-4"> Tags </th>
                            <th class="col-md-3"> <a (click)="sortByTime()">Time <span class="glyphicon glyphicon-sort"></span></a> </th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr *ngFor="let recipe of recipes| filter:listFilter.value | orderBy: order">
                                <td><a routerLink="/recipes/{{recipe.id}}"> {{recipe.name}}</a> </td>
                                <td><span *ngIf="recipe.ratingaverage"><rating [(ngModel)]="recipe.ratingaverage" [readonly]="true"></rating></span></td>
                                <td class="tag-td"> <span *ngFor="let tag of recipe.recipe_tags" class="label label-default list-tag-label">{{tag.tag.title}}</span> </td>
                                <td> <span *ngIf="recipe.duration">{{recipe.duration.range}}</span> </td>
                            </tr>
                        </tbody>
                    </table>-->

      </div>
      <div *ngIf="loading" class="loading-div"><img src="assets/gears.svg" align="center">
        <br> Fetching recipes from the nether realms..
      </div>
    </div>
  </div>

  <!-- Modal -->
  <div class="modal fade" id="myModal" role="dialog">
    <div class="modal-dialog">
    <div *ngIf="!rolling">
      <!-- Modal content-->
      <div class="modal-content  random-recipe" *ngIf="randomRecipe">
        <div class="modal-header" style="background-color:#022f32;">
          <button type="button" class="close" style="color:white;" data-dismiss="modal">&times;</button>
          <h4 class="modal-title" style="color:white;">{{randomRecipe.name}}</h4>
        </div>
        <div class="modal-body">
          <div>
            <rating [(ngModel)]="randomRecipe.ratingaverage" [readonly]="true"></rating> ({{randomRecipe.ratingcount}} ratings)
            <div style="float:right;margin-top:10px;" [ngSwitch]="randomRecipe.level.id"> <span *ngSwitchCase="3" class="label label-danger">Difficult</span> <span *ngSwitchCase="1" class="label label-success">Easy</span> <span *ngSwitchCase="2" class="label label-warning">Medium</span> </div>

          </div>

          <p><b>{{randomRecipe.duration.range}}</b></p>
           <p><i>{{randomRecipe.introduction}}</i></p>
          <p><a routerLink="/recipes/{{randomRecipe.id}}" data-dismiss="modal">Go to recipe <span class="glyphicon glyphicon-menu-right"></span><span class="glyphicon glyphicon-menu-right"></span></a></p>
          <span *ngIf="randomRecipe.coverpicture"><img class="random-image" src="{{baseUrl}}{{randomRecipe.coverpicture.picture.medium.url}}" ></span>
          <span *ngIf="!randomRecipe.coverpicture"><img class="random-image" src="assets/cookie.jpg"></span>
          <!--
          <div style="float:right;" *ngIf="!randomRecipe.coverpicture"><img  src="assets/baking.png" alt="nice pic yo"></div>
          <div style="float:right;" *ngIf="randomRecipe.coverpicture"><img  class="img-responsive" src="{{baseUrl}}{{recipe.coverpicture.picture.thumb.url}}"></div>
          -->
        </div>
        <div class="modal-footer">
          <p style="float:left;">Random Recipe</p><br><br>
          <span style="float:left;" *ngIf="randomRecipe.coverpicture"><p >Picture &copy; {{randomRecipe.coverpicture.author}}</p></span>
          <button type="button" class="btn btn-default" (click)="reRoll()">Reroll</button>
          <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
        </div>
      </div>

      </div>
      <div *ngIf="rolling">
        <div class="roller">
          <img src="assets/gears.svg">
        </div>
      </div>
    </div>
  </div>
</div>
